<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.BulletinReciveMapper">
    
    <resultMap type="BulletinRecive" id="BulletinReciveResult">
        <result property="reciveId"    column="RECIVE_ID"    />
        <result property="reciveUserId"    column="RECIVE_USER_ID"    />
        <result property="readTime"    column="READ_TIME"    />
        <result property="readNum"    column="READ_NUM"    />
        <result property="createTime"    column="CREATE_TIME"    />
        <result property="createUserId"    column="CREATE_USER_ID"    />
        <result property="updateUserId"    column="UPDATE_USER_ID"    />
        <result property="updateTime"    column="UPDATE_TIME"    />
        <result property="remark"    column="REMARK"    />
        <result property="bulletinId"    column="BULLETIN_ID"    />
        <result property="sts"    column="STS"    />
    </resultMap>

    <sql id="selectBulletinReciveVo">
        select RECIVE_ID, RECIVE_USER_ID, READ_TIME, READ_NUM, CREATE_TIME, CREATE_USER_ID, UPDATE_USER_ID, UPDATE_TIME, REMARK, BULLETIN_ID, STS from t_bulletin_recive
    </sql>

    <select id="selectBulletinReciveList" parameterType="BulletinRecive" resultMap="BulletinReciveResult">
        <include refid="selectBulletinReciveVo"/>
        <where>  
            <if test="reciveUserId != null "> and RECIVE_USER_ID = #{reciveUserId}</if>
            <if test="readTime != null "> and READ_TIME = #{readTime}</if>
            <if test="readNum != null "> and READ_NUM = #{readNum}</if>
            <if test="createTime != null "> and CREATE_TIME = #{createTime}</if>
            <if test="createUserId != null  and createUserId != ''"> and CREATE_USER_ID = #{createUserId}</if>
            <if test="updateUserId != null "> and UPDATE_USER_ID = #{updateUserId}</if>
            <if test="updateTime != null "> and UPDATE_TIME = #{updateTime}</if>
            <if test="remark != null  and remark != ''"> and REMARK = #{remark}</if>
            <if test="bulletinId != null "> and BULLETIN_ID = #{bulletinId}</if>
            <if test="sts != null  and sts != ''"> and STS = #{sts}</if>
            <if test="sts == null  or sts == ''">  and STS in ('A','C')</if>
        </where>
    </select>
    
    <select id="selectBulletinReciveUserIdByBulletinIds" parameterType="String" resultMap="BulletinReciveResult">
        select  RECIVE_USER_ID,  BULLETIN_ID from t_bulletin_recive where BULLETIN_ID in
        <foreach item="bulletinId" collection="array" open="(" separator="," close=")">
            #{bulletinId}
        </foreach>
    </select>
    
    <select id="selectBulletinReciveByReciveId" parameterType="String" resultMap="BulletinReciveResult">
        <include refid="selectBulletinReciveVo"/>
        where RECIVE_ID = #{reciveId}
    </select>
        
    <insert id="insertBulletinRecive" parameterType="BulletinRecive">
        insert into t_bulletin_recive
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="reciveId != null">RECIVE_ID,</if>
            <if test="reciveUserId != null">RECIVE_USER_ID,</if>
            <if test="readTime != null">READ_TIME,</if>
            <if test="readNum != null">READ_NUM,</if>
            <if test="createTime != null">CREATE_TIME,</if>
            <if test="createUserId != null and createUserId != ''">CREATE_USER_ID,</if>
            <if test="updateUserId != null">UPDATE_USER_ID,</if>
            <if test="updateTime != null">UPDATE_TIME,</if>
            <if test="remark != null and remark != ''">REMARK,</if>
            <if test="bulletinId != null">BULLETIN_ID,</if>
            <if test="sts != null and sts != ''">STS,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="reciveId != null">#{reciveId},</if>
            <if test="reciveUserId != null">#{reciveUserId},</if>
            <if test="readTime != null">#{readTime},</if>
            <if test="readNum != null">#{readNum},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="createUserId != null and createUserId != ''">#{createUserId},</if>
            <if test="updateUserId != null">#{updateUserId},</if>
            <if test="updateTime != null">#{updateTime},</if>
            <if test="remark != null and remark != ''">#{remark},</if>
            <if test="bulletinId != null">#{bulletinId},</if>
            <if test="sts != null and sts != ''">#{sts},</if>
         </trim>
    </insert>

    <update id="updateBulletinRecive" parameterType="BulletinRecive">
        update t_bulletin_recive
        <trim prefix="SET" suffixOverrides=",">
            <if test="reciveUserId != null">RECIVE_USER_ID = #{reciveUserId},</if>
            <if test="readTime != null">READ_TIME = #{readTime},</if>
            <if test="readNum != null">READ_NUM = #{readNum},</if>
            <if test="createTime != null">CREATE_TIME = #{createTime},</if>
            <if test="createUserId != null and createUserId != ''">CREATE_USER_ID = #{createUserId},</if>
            <if test="updateUserId != null">UPDATE_USER_ID = #{updateUserId},</if>
            <if test="updateTime != null">UPDATE_TIME = #{updateTime},</if>
            <if test="remark != null and remark != ''">REMARK = #{remark},</if>
            <if test="bulletinId != null">BULLETIN_ID = #{bulletinId},</if>
            <if test="sts != null and sts != ''">STS = #{sts},</if>
        </trim>
        where RECIVE_ID = #{reciveId}
    </update>
    
    <update id="batchUpdateRead">
     update t_bulletin_recive set
      READ_TIME = sysdate() ,
             READ_NUM = READ_NUM+1,
             sts ='A',
             UPDATE_TIME=sysdate(),
             UPDATE_USER_ID = RECIVE_USER_ID
        where RECIVE_ID  in
        <foreach item="reciveId" collection="array" open="(" separator="," close=")">
            #{reciveId}
        </foreach>
    </update>

    <delete id="deleteBulletinReciveByReciveId" parameterType="String">
        delete from t_bulletin_recive where RECIVE_ID = #{reciveId}
    </delete>

    <delete id="deleteBulletinReciveByReciveIds" parameterType="String">
        delete from t_bulletin_recive where RECIVE_ID in 
        <foreach item="reciveId" collection="array" open="(" separator="," close=")">
            #{reciveId}
        </foreach>
    </delete>
</mapper>